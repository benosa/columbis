= form_for @claim do |f|
  = f.error_messages
  %p
    = f.label :office_id, t('.office')
    = f.select :office_id, Office.all.collect {|o| [ o.name, o.id ] }
    = f.label :user_id, t('.user')
    = f.select :user_id, User.all.collect {|o| [ o.first_last_name, o.id ] }
  %hr

  %p
    = f.label :operator_confirmation, t('.operator_confirmation'), :class => 'narrow'
    = f.text_field :operator_confirmation, :class => 'narrow'

    = f.label :visa, t('.visa'), :class => 'narrow'
    = f.text_field :visa_check, :class => ('narrow datepicker ' << @claim.visa)
    = f.hidden_field :visa

    = f.label :check_date, t('.check_date'), :class => 'narrow'
    = f.text_field :check_date, :class => 'narrow datepicker'

  %p
    = f.label :operator_id, t('.operator')
    = f.select :operator_id, Operator.all.collect {|o| [ o.name, o.id ] }

  = t('.flights')
  %table
    %tr
      %th
      %th= t('.there')
      %th= t('.back')
    %tr
      %td= f.label :airport_to, t('.airport')
      %td= f.text_field :airport_to
      %td= f.text_field :airport_back
    %tr
      %td= f.label :flight_to, t('.flight')
      %td= f.text_field :flight_to
      %td= f.text_field :flight_back
    %tr
      %td= f.label :depart_to, t('.depart')
      %td= f.text_field :depart_to
      %td= f.text_field :depart_back
    %tr
      %td= f.label :time_to, t('.time')
      %td= f.text_field :time_to
      %td= f.text_field :time_back
  %p
    = f.label :description, t('.description')
    %br
    = f.text_area :description, :cols => 80, :rows => 6
  %hr
  .data_block
    = t('.tour_price')
    = f.label :currency
    = f.select :currency, (CurrencyCourse::CURRENCIES).collect {|o| [ o.upcase, o ] }
    = f.label :course
    = f.text_field :course, :class => 'width_100'
    %table#tour_price
      %tr
        %th= t('.tour_price')
        %th= t('.visa_price')
        %th= t('.insurance_price')
        %th= t('.additional_insurance_price')
        %th= t('.fuel_tax_price')
        %th= t('.total_tour_price')
      %tr
        %td= f.text_field :tour_price, :class => 'red'
        %td= f.text_field :visa_price
        %td= f.text_field :insurance_price
        %td= f.text_field :additional_insurance_price
        %td= f.text_field :fuel_tax_price
        %td= f.text_field :total_tour_price, :class => 'red'
      %tr
        %th{ :colspan => 6 }
          = t('.primary_currency_price')
      %tr
        %td= f.text_field :primary_currency_price, :class => 'red'
        %td{ :colspan => 5 }
          = text_field_tag :price_as_string, @claim.primary_currency_price, :class => 'red'

  %hr
  .data_block
    = t('.tourists')
    %table#tourists
      %tr
        %th{ :style => 'width: 20px;' }
        %th{ :style => 'width: 220px;' }
          = t('.full_name')
        %th= t('.date_of_birth')
        %th{ :colspan => 2 }
          = t('.passport')
        %th= t('.passport_expire')
        %th{ :style => 'width: 50px;' }
      = f.fields_for :tourist, @claim.tourist do |builder|
        %tr.applicant
          = render :partial => 'tourist', :locals => { :builder => builder }
        %tr
          %td
          %td= builder.text_field :phone_number, :class => 'phone_number'
          %td{ :colspan => 4 }
            = builder.text_field :address, :class => 'address'
      - ind = 2
      = f.fields_for :tourists, @claim.tourists do |builder|
        %tr.dependent{ :id => "dependent#{ind}"}
          = render :partial => 'tourist', :locals => { :builder => builder, :ind => ind }
      %tr.footer
        %td{ :colspan => 6 }
          = link_to t('.add_another_tourist'), '#', :class => 'add'
  %p
    = f.submit
  %table.invisible
    = f.fields_for :tourist, Tourist.new do |builder|
      %tr#new_tourist
        = render :partial => 'tourist', :locals => { :builder => builder }
