.claims
  %table#claims{ :rules => 'all'}
    %tr
      %th= sortable 'id', t('claims.index.num')
      %th= sortable 'reservation_date', t('claims.index.reservation_date')
      %th= sortable 'user_id', t('claims.index.manager')
      /%th= sortable 'applicant.last_name', t('claims.index.full_name')
      %th= t('claims.index.full_name')
      %th= sortable 'countries.name', t('claims.index.to')
      %th.medium= sortable 'airport_back', t('claims.index.from')
      %th= sortable 'visa', t('claims.index.visa')
      %th= sortable 'check_date', t('claims.index.term')
      %th= sortable 'depart_to', t('claims.index.depart_to')
      %th= sortable 'depart_back', t('claims.index.depart_back')
      %th= sortable 'operators.name', t('claims.index.operator')
      %th= sortable 'primary_currency_price', t('claims.index.price')
      %th= sortable 'calculation', t('claims.index.calculation')
      %th= sortable 'tourist_advance', t('claims.index.advance')
      %th= sortable 'tourist_debt', t('claims.index.debt')
      %th= sortable 'operator_price', t('claims.index.operator_price')
      %th= sortable 'operator_maturity', t('claims.index.operator_payment_term')
      %th= sortable 'operator_advance', t('claims.index.operator_paid')
      %th= sortable 'operator_debt', t('claims.index.operator_debt')
      %th= sortable 'tourist_paid', t('claims.index.paid')
      %th= sortable 'docs_ticket', t('claims.index.docs')
      %th= sortable 'docs_note', t('claims.index.memo')
      %th= sortable 'check_date', t('claims.index.check_date')
      %th
    - @claims.each do |claim|
      %tr
        %td{ :class => "#{ claim.early_reservation ? 'green_back' : '' }" }
          = claim.id
        %td= l( claim.reservation_date, :format => :default )
        %td{ :style => "background-color:#{claim.user.color}" }
          = claim.user.login
        %td= claim.applicant.try(:full_name)
        %td= claim.country.try(:name)
        %td= claim.city.try(:name)
        %td{ :class => claim.visa }
          = claim.visa_confirmation_flag ? t('yep') : t('nope')
        %td= l( claim.check_date, :format => :short )
        %td{ :class => claim.flight_status }
          = l( claim.depart_to, :format => :short )
        %td{ :class => claim.flight_status }
          = l( claim.depart_back, :format => :short )
        %td= claim.operator.try(:name)
        %td{ :class => "#{ claim.has_tourist_debt? ? 'red_back' : '' }" }
          = claim.primary_currency_price.to_money
        %td= claim.calculation
        %td{ :class => "#{ claim.has_tourist_debt? ? 'red_back' : '' }" }
          = claim.tourist_advance.to_money
        %td{ :class => "#{ claim.has_tourist_debt? ? 'red_back' : '' }" }
          = claim.tourist_debt.to_money
        %td= "#{claim.operator_price_currency.upcase}: #{claim.operator_price.to_money}" if claim.operator_price > 0
        %td= l( claim.operator_maturity, :format => :short )
        %td= claim.operator_advance.to_money
        %td= claim.operator_debt.to_money
        %td{ :class => "#{ claim.early_reservation ? 'green_back' : '' }" }
          = claim.tourist_paid
        %td{ :class => "#{ claim.docs_ready? ? '' : 'red_back'  }" }
          = claim.docs_ready? ? t('claims.index.ready') : t('claims.index.not_ready')
        %td{ :class => "#{ claim.docs_note == ''? '' : 'red_back' }" }
          %div{ :class => "#{ claim.docs_note == ''? '' : 'tooltip' }" }
            = (claim.docs_note.nil? or claim.docs_note.blank?) ? t('nope') : truncate(claim.docs_note, :length => 25)
            %span
              = claim.docs_note
              %small
        %td{ :class => claim.check_date_status }
          = l( claim.check_date, :format => :default )
        %td
          = link_to t('edit'), edit_claim_path(claim)
          = link_to t('destroy'), claim, :confirm => t('are_you_sure'), :method => :delete

  = will_paginate @claims
