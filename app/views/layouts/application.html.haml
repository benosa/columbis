!!!
%html{ :manifest => params[:offline] && '/tourism.manifest', :class => yield(:html_class) }
  %head
    %title
      = yield(:title) || 'Untitled'
    %meta{'http-equiv'=>'Content-Type', :content=>'text/html; charset=utf-8'}/
    - if javascript_local_data
      = javascript_tag(javascript_local_data)
    = stylesheet_link_tag 'application'
    - if small_width?
      = stylesheet_link_tag 'new_design/css/low'
    - elsif medium_width?
      = stylesheet_link_tag 'new_design/css/middle'
    - elsif large_width?
      = stylesheet_link_tag 'new_design/css/high'
    = stylesheet_link_tag 'common'
    = javascript_include_tag 'application'
    / [if lt IE 9]
      = javascript_include_tag 'css3-mediaqueries'
    = csrf_meta_tag
    = yield(:head)

  %body{ :class => "#{body_class} #{yield(:body_class)}".strip }
    #container.all

      .header

        %ul#documents_to_print_menu.reservation
          %li{:class => (params[:controller] == 'claims' and params[:action] == 'index') ? 'active' : ' '}
            = link_to 'Брони', claims_path, :id => 'claims_link'
          %li{:class => (params[:controller] == 'claims' and params[:action] == 'new') ? 'active' : ' '}
            = link_to 'Новая заявка', new_claim_path
          %li.dropdown
            %a{:href => '#'} Документы
            %ul
              - { :contract => 'Договор',
              :permit => 'Путевка',
              :warranty => 'Фингарантии',
              :memo => ['Памятка', :memo_printer_for, :country],
              :act => 'Акт' }.each do |mode, value|
                %li{ :class => li_class(@claim, mode) }
                  - unless value.is_a?(Array)
                    - if @claim && !@claim.new_record? && @claim.company.try("#{mode}_printer".to_sym)
                      = link_to(value, claim_path(@claim.id, :print => mode), :target => '_blank')
                    - else
                      %span= value
                  - else
                    - if @claim && !@claim.new_record? && @claim.company.try(value[1], @claim.try(value[2]))
                      = link_to(value[0], claim_path(@claim.id, :print => mode), :target => '_blank')
                    - else
                      %span= value[0]
              %li= link_to 'Приходник', '#'
          %li= link_to 'Справка', '#'
          / %li

          / - if can? :switch_view, current_user
          /   %li= link_for_view_switcher


        %ul.user_panel
          = render 'devise/menu/registration_items'
          = render 'devise/menu/login_items'

        .clear

        %ul#databases_menu.databases
          / %li
          /   %span Базы
          %li.dropdown
            %a{:href => '#'} Управление
            %ul
              %li= link_to t('.company'), dashboard_edit_company_path
              %li= link_to t('.users'), dashboard_users_path
              %li= link_to t('.operators'), operators_path
              %li= link_to t('.dropdown_values'), dashboard_dropdown_values_path
              %li= link_to t('.tourists'), tourists_path
              %li= link_to t('.addresses'), addresses_path
              %li= link_to t('.catalogs'), catalogs_path
          / %li{ :class => controller.controller_name == 'addresses' && 'active' }
          /   = link_to 'Реквизиты фирмы', dashboard_edit_company_path
          %li{ :class => controller.controller_name == 'tourists' && 'active' }
            = link_to 'Туристы', tourists_path
          %li{ :class => params[:controller] == 'operators' && 'active' }
            = link_to 'Туроператоры', operators_path
          %li= link_to 'Симки', '#'
          %li= link_to 'Агентства', '#'

        - if view_switcher?
          .type
            %p Вид:
            %select#view_switcher
              %option{ :value => current_path(:list_type => 'manager_list'), :selected => params[:list_type] == 'manager_list' && 'selected' }
                = t('claims.index.manager_list')
              %option{ :value => current_path(:list_type => 'accountant_list'), :selected => params[:list_type] == 'accountant_list' && 'selected' }
                = t('claims.index.accountant_list')

      .clear

      - if content_for? :success_messages or content_for? :error_messages or !flash.empty?
        .messages
          - if content_for? :success_messages
            .alert.alert-success
              = link_to '&times;'.html_safe, '#', :class => 'close',  :'data-dismiss' => 'alert'
              = yield :success_messages
          - elsif content_for? :error_messages
            .alert.alert-error
              = link_to '&times;'.html_safe, '#', :class => 'close',  :'data-dismiss' => 'alert'
              = yield :error_messages
          - else
            - alert_classes = { :notice => :success, :alert => :error }
            - flash.each do |name, msg|
              = content_tag :div, :id => "flash_#{name}", :class => "alert alert-#{alert_classes[name]}" do
                = link_to '&times;'.html_safe, '#', :class => 'close',  :'data-dismiss' => 'alert'
                = msg

      .wrapper
        #content.content
          .top
            - if show_title?
              %h1= yield :title
            - if content_for? :top
              = yield :top
          .clear

          = yield

    - if content_for? :float_panel
      .float_panel
        .panel_content
          = yield :float_panel

    .footer
      .footer_content
        %p.copy &copy; Devmen. All rights reserved, 2012
        %p.right tourism.devmen.com

    #popup
