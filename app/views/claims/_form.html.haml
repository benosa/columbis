= form_for @claim do |f|
  = f.error_messages
  %p
    = f.label :office_id, t('.office')
    = f.select :office_id, Office.all.collect {|o| [ o.name, o.id ] }
    = f.label :user_id, t('.user')
    = f.select :user_id, User.all.collect {|o| [ o.first_last_name, o.id ] }
  %hr

  %p
    = f.label :operator_confirmation, t('.operator_confirmation'), :class => 'narrow'
    = f.text_field :operator_confirmation, :class => 'narrow'

    = f.label :visa, t('.visa'), :class => 'narrow'
    = f.text_field :visa_check, :class => ('narrow datepicker ' << @claim.visa)
    = f.hidden_field :visa

    = f.label :check_date, t('.check_date'), :class => 'narrow'
    = f.text_field :check_date, :class => 'narrow datepicker'

  %p
    = f.label :operator_id, t('.operator')
    = f.select :operator_id, Operator.all.collect {|o| [ o.name, o.id ] }

  = t('.flights')
  %table
    %tr
      %th
      %th= t('.there')
      %th= t('.back')
    %tr
      %td= f.label :airport_to, t('.airport')
      %td= f.text_field :airport_to
      %td= f.text_field :airport_back
    %tr
      %td= f.label :flight_to, t('.flight')
      %td= f.text_field :flight_to
      %td= f.text_field :flight_back
    %tr
      %td= f.label :depart_to, t('.depart')
      %td= f.text_field :depart_to
      %td= f.text_field :depart_back
    %tr
      %td= f.label :time_to, t('.time')
      %td= f.text_field :time_to
      %td= f.text_field :time_back
  %p
    = f.label :description, t('.description')
    %br
    = f.text_area :description, :cols => 80, :rows => 6
  %hr
  .data_block
    = t('.tour_price')
    = f.label :currency
    = f.select :currency, (CurrencyCourse::CURRENCIES).collect {|o| [ o.upcase, o ] }
    = f.label :course
    = f.text_field :course, :class => 'width_100'
    %table
      %tr
        %th= t('.tour_price')
        %th= t('.visa_price')
        %th= t('.insurance_price')
        %th= t('.additional_insurance_price')
        %th= t('.fuel_tax_price')
        %th= t('.total_tour_price')
      %tr
        %td= f.text_field :tour_price, :class => 'red'
        %td= f.text_field :visa_price
        %td= f.text_field :insurance_price
        %td= f.text_field :additional_insurance_price
        %td= f.text_field :fuel_tax_price
        %td= f.text_field :total_tour_price, :class => 'red'
      %tr
        %th{ :colspan => 6 }
          = t('.primary_currency_price')
      %tr
        %td= f.text_field :primary_currency_price, :class => 'red'
        %td{ :colspan => 5 }
          = text_field_tag :price_as_string, @claim.primary_currency_price, :class => 'red'

  %hr
  .data_block
    = t('.tourists')
    %table
      %tr
        %th{ :style => 'width: 20px;' }
        %th{ :style => 'width: 220px;' }
          = t('.full_name')
        %th= t('.date_of_birth')
        %th{ :colspan => 2 }
          = t('.passport')
        %th= t('.passport_expire')
        %th
      %tr#new_tourist{ :style => 'display:none' }
        %td
        %td= text_field_tag :full_name
        %td= text_field_tag :date_of_birth
        %td= text_field_tag :passport_series
        %td= text_field_tag :passport_number
        %td.datepicker= text_field_tag :passport_valid_until, nil, :class => 'datepicker'
        %td= link_to t('.add'), '#'
      = f.fields_for :tourist, @claim.tourist do |builder|
        %tr
          %td 1
          %td= builder.text_field :full_name, :autocomplete => autocomplete_tourist_last_name_claims_path,
            :id_element => 'tourist_1', :size => 20, :class => 'autocomplete full_name'
          %td.datepicker= builder.text_field :date_of_birth, :class => 'datepicker date_of_birth', :style => 'width: 85%;'
          %td= builder.text_field :passport_series, :class => 'passport_series', :style => 'width: 90%;'
          %td= builder.text_field :passport_number, :class => 'passport_number'
          %td.datepicker= builder.text_field :passport_valid_until, :class => 'datepicker passport_valid_until', :style => 'width: 85%;'
          %td= link_to t('.add'), '#'
        %tr.additional_info
          %td
          %td= builder.text_field :phone_number, :class => 'phone_number'
          %td{ :colspan => 4, :class => 'address' }
            = builder.text_field :address
      - @claim.tourists.each_with_index do |trst, i|
        %tr
          %td= i + 1
          %td= trst.full_name
          %td= trst.date_of_birth
          %td= trst.passport_series
          %td= trst.passport_number
          %td= trst.passport_valid_until
          %td= link_to t('.add'), '#'
  %p
    = f.submit
