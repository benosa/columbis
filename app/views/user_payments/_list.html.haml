.current_container
  %table.reservations.tour_operators
    %tr
      %th= sort_link :invoice, t('.invoice')
      %th
        %span= t('.description')
      %th
        %span= t('.amount')
      %th= sort_link(:updated_at, t('.updated_at'), :default)
      %th
        %span= t('.status')
      %th.actions
        %span= t('actions')

    - for user_payment in @user_payments
      %tr{ :class => cycle('odd', 'even'), id: "user_payment_#{user_payment.id}" }
        %td
          %p= user_payment.invoice
        %td
          %p= truncate user_payment.description, length: 30, omission: '...', separator: ' '
        %td
          %p= user_payment.amount.to_s + " " + t(user_payment.currency)
        %td
          %p= l(user_payment.updated_at, :format => "%d.%m.%Y %H:%M")
        %td{ :width => "100px" }
          - unless user_payment.status == 'new'
            %p= t(".statuses.#{user_payment.status}")
          - else
            = payment_service_for user_payment[:invoice], CONFIG[:robokassa_login], :amount =>  user_payment[:amount], :service => :robokassa, :secret => CONFIG[:robokassa_password1] do |s|
              = submit_tag t('.confirm')
        %td{ :width => "50px" }
          - if can? :destroy, user_payment
            = link_to '', user_payment, :confirm => t('are_you_sure'), :method => :delete, :class => 'delete', :title => t('delete'), id: "delete__#{user_payment.id}", :style => "margin-left:10px"

  = render :partial => 'shared/pagination', :locals => { :collection => @user_payments }